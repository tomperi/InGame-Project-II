// room script file

// Interact with the tree
function hHotspot2_Interact()
{
  if (!treeOpen) {
    // Open the tree eye
    if(player.x > 370 && player.x < 700){
      oEye.SetView(4, 0, 0);
      oEye.Visible=true;
      oEye.Animate(0, 2, eOnce, eBlock);
      dDialog1.Start();
      treeOpen=true;
    }
    else{
      player.Say("What a weird looking tree...");
    }
  } else {
    // Generate tears
    player.Say("I'm going to poke that stupid tree in the yee");
    player.Walk(681, 360, eBlock, eWalkableAreas);
    player.FaceDirection(eDirectionLeft);
    Wait(15);
    oTear.SetView(6, 0, 0);
    oTear.Visible=true;
    oTear.Clickable=true;
    oTear.Animate(0, 4, eOnce, eNoBlock);
    SetTimer(1, 300);
  }
}

function hHotspot2_Talk()
{
  // Talk to the tree
  if(player.x > 370 && player.x < 700){
    dDialog1.Start();
  }
  else{
    player.Say("What a weird looking tree...");
  }
}

// Interact with jacob
function hHotspot3_AnyClick()
{
  if (!talkedToJacob) {
    if (player.x > 140) 
      player.Animate(1, 0, eOnce, eNoBlock);
    player.Say("Wake up Jacob!");
    oLeg.Move(355, 345, 1, eBlock, eAnywhere);
    oLeg.Visible=false;
    cJacob.Animate(1, 2, eOnce, eBlock);
    cJacob.Animate(2, 0, eOnce, eBlock);
    cJacob.Say("HOOOLLAAAA");
    talkedToJacob=true;
  } else  
    player.Say("You want me to touch the old man?");
    //Add dialog Oli: Give me hat -> Jacob: No free lunch, speaking of lunch I'm hungry.
}

// Interact with the hole in the tree
function hHotspot1_Interact()
{
  if(room3empty){
    player.Say("There's nothing interesting in there...");
  }
  else{
    if (player.x < 190) {
      player.Say("Oh... what's in here?");
      Wait(2);
      player.ChangeRoomAutoPosition(3);
    } else {
      player.Say("That's too far for me to do that");
    }
  }
 }
function hHotspot4_WalkOn()
{
 oPlantArea.Clickable = 1;
}

function oPlantArea_AnyClick()
{
//  Check if player has items for flower, if not Display
// ("This seemslike a great place for a flower!")
}

function room_Load()
{
  gIconbar.Visible=true;
  gIconbar2.Visible=true;
}

// Planet the seed and w ater it 
function hHotspot4_UseInv()
{
  if (cChar1.ActiveInventory == iSeed) {
    player.Say("I'm going to plant the seed in that hole");
    player.Walk(820, 350, eBlock, eWalkableAreas); 
    player.FaceDirection(eDirectionRight);
    oPlantedSeed.Visible = true;
    cChar1.LoseInventory(iSeed);
    mouse.ChangeModeView(eModeWalkto, 0);
    player.Say("The seed is strong with this one!");
  } 
  
  if (player.ActiveInventory == iHatWithWater) {
    if (oPlantedSeed.Visible) {
      player.LoseInventory(iHatWithWater);
      oFlower.SetView(7, 0, 0);
      oPlantedSeed.Visible = false;
      oFlower.Visible = true;
      oFlower.Animate(0, 2, eOnce, eBlock);
    } else {
      player.Say("I'm not going to waste my water on an empty hole");
    }
  }
}

function room_RepExec()
{
  if (IsTimerExpired(1))
    oTear.Visible=false;
}

function oTear_Interact()
{
  player.Say("I can't catch that with my bear hands");
}

// Catch the tear with the hat!


function oTear_UseInv()
{
  if (cChar1.ActiveInventory == iHat) {
    oTear.Visible=false;
    player.Say("Woho, I have some water in the hat");
    cChar1.LoseInventory(iHat);
    player.AddInventory(iHatWithWater);
  }
}
function oFlower_Interact()
{
  if (player.x < 790) 
    player.Walk(800, 370, eBlock, eWalkableAreas);
  if (player.x > 990)
    player.Walk(970, 370, eBlock, eWalkableAreas);
  Wait(10);
  finishedDarkForest = true;
  player.ChangeRoom(1, 900, 335, eDirectionLeft);
  cJacob.ChangeRoom(1, 680, 365, eDirectionRight);
}

function oFlower_Look()
{
    player.Say("A FUCKING FLOWER!!! WE CAN GO BACK HOME!!");
}
